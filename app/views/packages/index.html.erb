<div id="app">
  <div class="wrapper row3">
    <main class="hoc container clear btmpad-none">
      <div class="content">
        <% if flash[:error]  %>
          <div class="alert alert-warning"> <%= flash[:error] %></div> 
        <% end %>
        <% if flash[:notice]  %>
          <div class="alert alert-success"> <%= flash[:notice] %></div> 
        <% end %>

        <h2 class="receivername title-divider"><span>物品明细</span></h2>

        <div id="comments" class="scrollable">
          <div class="pkglist">
            <table v-if="packageItems.length > 0">
              <tbody>
              <tr v-for="item in packageItems">
                <td>{{item.name}}</td>
                <td>{{item.quantity}}</td>
                <td>{{item.country}}</td>
                <td><a class="btn smlbtn inverse" v-on:click="removePackageItem(item)">删除</a></td>
              </tr>
              </tbody>
            </table>
          </div>
          <%= form_tag do %>
              <div class="one_third first">
                <%= text_field_tag(:name, '', :required => true, :placeholder =>'名称', 'v-model': 'packageItem.name') %>
              </div>
              <div class="one_third">
                <%= number_field_tag(:name, '', :required => true, :min => 0, :step => 1, :placeholder=> '数量', 'v-model': 'packageItem.quantity') %>
              </div>
              <div class="one_third">
                <%= text_field_tag(:country, '', :required => true, :placeholder => "产地", 'v-model': 'packageItem.country') %>
              </div>
              <div class="one_quarter first mgt-small">
                <input class="narrow_input" type="checkbox" v-model='luxury'>
                  轻奢侈品
              </div>
              <div class="clear"></div>
              <div class="one_quarter first">
                <a class="btn smlbt" v-on:click="addPackageItem()">确定</a>
              </div>
          <% end %>
        </div>
      </div>
    </main>
  </div>
  <div class="wrapper row3">
    <main class="hoc container clear btmpad-none">
      <div class="content">
        <h2 class="receivername title-divider"><span>选择收件人地址</span></h2>
        <div id="comments"> 
          <p class="divider">收件人是否在列表中？如果是，请点击选此收件人。若否，请 <%= link_to '新建收件人地址', new_address_path(:returnUrl => packages_path) %></p>
          <div class="one_third first" v-if="addresses.length > 6">
            <input type="text" placeholder="姓名，电话，身份证" v-model="query"> 
          </div>
          <div class="clear"></div> 
          <address-label v-for="(address, index) in addresses" v-bind:pos="index" v-bind:selected="selectedAddress === address" v-bind:address="address" v-on:delete="removeAddress(address)" v-on:selected="selectAddress(address)"></address-label>
        </div>
      </div>
    </main>
  </div>
  <div class="wrapper row1">
    <main class="hoc container clear">
      <div class="content">

        <%= form_for @package, url: {action: 'create'}, html: {} do |f| %>
            <div class="block">
              <%= f.hidden_field :address_id, "v-model": "selectedAddress.id" %>
              <%= f.hidden_field :package_items, "v-bind:value": "JSON.stringify(packageItems)" %>
              <%= f.hidden_field :luxury, "v-model": "luxury" %>
              <%= f.submit '确认订单', "v-bind:disabled": "disableSubmit", "class": 'btn' %>
            </div>
        <% end %>

      </div>
    </main>
  </div>
</div>
